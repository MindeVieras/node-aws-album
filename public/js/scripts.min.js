var ModalData;var ModalList=[];var Album=function(){"use strict";return{makeModalTarget:function(id){if(!id){id=UUID.generate()}if(id[0]=="#"){id=id.substring(1)}$("#modaltemplate").clone().attr("id",id).insertAfter("#modaltemplate");return"#"+id},populateModalDataFields:function(btn){ModalData=JSON.parse(JSON.stringify($(btn).data()));delete ModalData.loading;delete ModalData.remote;delete ModalData.style;delete ModalData.target;delete ModalData.toggle;delete ModalData.size;delete ModalData.type;delete ModalData.function;delete ModalData.functiondelay}}}();$(document).ready(function(){$(document.body).on("click","[data-remote!=''][data-remote]",function(event){event.preventDefault();var options=JSON.parse(JSON.stringify($(this).data()));Album.openModal(options,this)});$(document.body).on("click","[data-function!=''][data-function]",function(event){event.preventDefault();var btn=this;var functionName=$(this).data("function");var fn=getFunctionFromString(functionName);var sleep=0;var info=$(this).data();for(k in info){info[k]=$(this).attr("data-"+k)}if(typeof fn==="function"){if($(this).data("functionDelay")){var sleep=parseInt($(this).data("functionDelay"))}setTimeout(function(){console.log("Executing function: "+functionName+" after delay of "+sleep+" milliseconds");fn(info,btn)},sleep)}else{console.log("No such function: "+functionName)}});$(document).on("show.bs.modal",".modal",function(){var modal=this;var hash=modal.id;window.location.hash=hash;window.onhashchange=function(){if(!location.hash){$(modal).modal("hide")}};var zIndex=1040+10*$(".modal:visible").length;$(this).css("z-index",zIndex);setTimeout(function(){$(".modal-backdrop").not(".modal-stack").css("z-index",zIndex-1).addClass("modal-stack")},0)});$(document).on("hide.bs.modal",function(){var hash=this.id;history.pushState("",document.title,window.location.pathname)});$(document).on("hidden.bs.modal",function(){$(ModalList.pop()).remove()});Album.initView();window.getFunctionFromString=function(string){var scope=window;var scopeSplit=string.split(".");for(i=0;i<scopeSplit.length-1;i++){scope=scope[scopeSplit[i]];if(scope==undefined)return}return scope[scopeSplit[scopeSplit.length-1]]}});Album.addAlbum=function(){$("#add_album #start_date").datetimepicker({format:"DD-MM-YYYY, HH:mm:ss",date:moment()});$("#add_album #start_date").on("dp.change",function(e){$("#add_album #end_date").data("DateTimePicker").minDate(e.date)});$("#add_album #end_date").datetimepicker({format:"DD-MM-YYYY, HH:mm:ss",date:moment(),useCurrent:false});$("#add_album #end_date").on("dp.change",function(e){$("#add_album #start_date").data("DateTimePicker").maxDate(e.date)});$("#add_album").validate({rules:{name:{required:true},start_date:{required:true},end_date:{required:true}},submitHandler:function(form){var data={id:$("#add_album #id").val(),name:$("#add_album #name").val(),start_date:$("#add_album #start_date").data("DateTimePicker").date().format("YYYY-MM-DD HH:mm:ss"),end_date:$("#add_album #end_date").data("DateTimePicker").date().format("YYYY-MM-DD HH:mm:ss")};console.log(data);$.ajax({type:"POST",data:data,url:"/album/add",dataType:"json",success:function(res){console.log(res);if(res.ack=="ok"){window.location.replace("/albums")}else{$("#add_album .error-msg").text(res.msg)}}});return false}})};Album.initView=function(){Album.initDatepicker()};Album.initDatepicker=function(){console.log("date pickers inited")};Album.addUser=function(){$("#add_user").validate({rules:{username:{required:true}},submitHandler:function(form){var data={id:$("#add_user #id").val(),username:$("#add_user #username").val(),email:$("#add_user #email").val(),display_name:$("#add_user #display_name").val(),password:$("#add_user #password").val(),confirm_password:$("#add_user #confirm_password").val(),access_level:$("#add_user #access_level").val(),status:$("#add_user #status").is(":checked")?1:0};$.ajax({type:"POST",data:data,url:"/user/add",dataType:"json",success:function(res){console.log(res);if(res.ack=="ok"){window.location.replace("/users")}else{$("#add_user .error-msg").text(res.msg)}}});return false}})};
//# sourceMappingURL=scripts.min.js.map